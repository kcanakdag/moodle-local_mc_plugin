define("local_mc_plugin/local/admin/event_selector",["exports","./selectors","core/str"],(function(_exports,_selectors,_str){var obj;
/**
   * Event selector module for the admin settings page.
   *
   * Handles event search, filtering, and bulk selection.
   * Uses data-* attributes from event_selector.mustache template.
   *
   * @module     local_mc_plugin/local/admin/event_selector
   * @copyright  2025 Kerem Can Akdag
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.setSyncedEvents=_exports.refreshCounter=_exports.init=void 0,_selectors=(obj=_selectors)&&obj.__esModule?obj:{default:obj};let syncedEvents=[],strings={},container=null,hiddenInput=null,counterEl=null;const loadStrings=async()=>{const results=await(0,_str.get_strings)([{key:"event_selected_count",component:"local_mc_plugin"},{key:"event_all_synced",component:"local_mc_plugin"},{key:"event_new",component:"local_mc_plugin"},{key:"event_removed",component:"local_mc_plugin"}]);strings={selectedCount:results[0],allSynced:results[1],newEvents:results[2],removed:results[3]}},updateValue=()=>{if(!hiddenInput||!counterEl)return;const selected=[];if((container?container.querySelectorAll("".concat(_selectors.default.events.checkbox,":checked")):document.querySelectorAll("".concat(_selectors.default.events.checkbox,":checked, ").concat(_selectors.default.events.legacyCheckbox,":checked"))).forEach((cb=>{const eventItem=cb.closest(_selectors.default.events.eventItem);eventItem&&eventItem.dataset.class&&selected.push(eventItem.dataset.class)})),hiddenInput.value=selected.join(","),syncedEvents.length>0){const toAdd=selected.filter((evt=>!syncedEvents.includes(evt))).length,toRemove=syncedEvents.filter((evt=>!selected.includes(evt))).length;if(0===toAdd&&0===toRemove)counterEl.innerHTML=strings.selectedCount.replace("{$a}",selected.length)+' <span class="text-success">• '.concat(strings.allSynced,"</span>");else{const changes=[];toAdd>0&&changes.push("".concat(toAdd," ").concat(strings.newEvents)),toRemove>0&&changes.push("".concat(toRemove," ").concat(strings.removed)),counterEl.innerHTML=strings.selectedCount.replace("{$a}",selected.length)+' <span class="text-warning">• '.concat(changes.join(", "),"</span>")}}else counterEl.textContent=strings.selectedCount.replace("{$a}",selected.length)},filterEvents=term=>{const lowerTerm=term.toLowerCase();(container?container.querySelectorAll(_selectors.default.events.eventItem):document.querySelectorAll(_selectors.default.events.eventItem)).forEach((item=>{item.textContent.toLowerCase().includes(lowerTerm)?item.classList.remove(_selectors.default.events.hiddenClass):item.classList.add(_selectors.default.events.hiddenClass)}));(container?container.querySelectorAll(_selectors.default.events.category):document.querySelectorAll(_selectors.default.events.category)).forEach((cat=>{0===cat.querySelectorAll("".concat(_selectors.default.events.eventItem,":not(.").concat(_selectors.default.events.hiddenClass,")")).length?cat.classList.add(_selectors.default.events.hiddenClass):cat.classList.remove(_selectors.default.events.hiddenClass)}))},selectVisible=()=>{const selector="".concat(_selectors.default.events.eventItem,":not(.").concat(_selectors.default.events.hiddenClass,") ").concat(_selectors.default.events.checkbox);(container?container.querySelectorAll(selector):document.querySelectorAll(selector)).forEach((cb=>{cb.checked=!0})),updateValue()},deselectVisible=()=>{const selector="".concat(_selectors.default.events.eventItem,":not(.").concat(_selectors.default.events.hiddenClass,") ").concat(_selectors.default.events.checkbox);(container?container.querySelectorAll(selector):document.querySelectorAll(selector)).forEach((cb=>{cb.checked=!1})),updateValue()};_exports.setSyncedEvents=events=>{syncedEvents=events||[]};_exports.refreshCounter=inputId=>{updateValue()};_exports.init=async function(){let inputId=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(await loadStrings(),container=document.querySelector(_selectors.default.events.container),container){hiddenInput=container.querySelector(_selectors.default.events.hiddenInput),counterEl=container.querySelector(_selectors.default.events.counter);const searchInput=container.querySelector(_selectors.default.events.searchInput);searchInput&&searchInput.addEventListener("keyup",(e=>{filterEvents(e.target.value)}));const selectBtn=container.querySelector(_selectors.default.events.selectVisibleBtn);selectBtn&&selectBtn.addEventListener("click",selectVisible);const deselectBtn=container.querySelector(_selectors.default.events.deselectVisibleBtn);deselectBtn&&deselectBtn.addEventListener("click",deselectVisible),container.querySelectorAll(_selectors.default.events.categoryTitle).forEach((title=>{title.style.cursor="pointer",title.addEventListener("click",(()=>{const events=title.nextElementSibling;events&&(events.style.display="none"===events.style.display?"block":"none")}))}))}else if(inputId){hiddenInput=document.getElementById(inputId),counterEl=document.querySelector(_selectors.default.events.legacyCounter(inputId));const searchInput=document.querySelector(_selectors.default.events.legacySearchInput(inputId));searchInput&&searchInput.addEventListener("keyup",(e=>{filterEvents(e.target.value)}));const selectBtn=document.querySelector(_selectors.default.events.legacySelectVisibleBtn(inputId));selectBtn&&selectBtn.addEventListener("click",selectVisible);const deselectBtn=document.querySelector(_selectors.default.events.legacyDeselectVisibleBtn(inputId));deselectBtn&&deselectBtn.addEventListener("click",deselectVisible),document.querySelectorAll(_selectors.default.events.categoryTitle).forEach((title=>{title.style.cursor="pointer",title.addEventListener("click",(()=>{const events=title.nextElementSibling;events&&(events.style.display="none"===events.style.display?"block":"none")}))}))}updateValue(),document.addEventListener("change",(e=>{(e.target.matches(_selectors.default.events.checkbox)||e.target.matches(_selectors.default.events.legacyCheckbox))&&updateValue()}))}}));

//# sourceMappingURL=event_selector.min.js.map